# D-PERAMS
Downloadable templates and instructions for D-PERAMS

D-PERAMS is software used to perform ecological risk assessments in data-poor contexts.  It provides as statistical interpretation of risk for each species or endpoint analyzed.  This metric is probabilistic Vulnerability (Vp). Inputs are attribute scores and weights for two variables: response (e.g. Productivity, Effect, Sensitivity, Severity) and stressor (e.g. Susceptibility, Exposure, Likelihood).  D-PERAMS is designed to incorporate multiple stressors that when aggregated can have compound impacts on risk or not. This software is associated with Grewelle et al. 2021, Data-Poor Ecological Risk Assessment of Multiple Stressors.  This paper builds on previous work which constructs a statistical framework for data-poor risk assessments in fisheries with single stressors, Grewelle et al. 2021, Redefining Risk in Data-Poor Fisheries https://onlinelibrary.wiley.com/doi/abs/10.1111/faf.12561, https://github.com/grewelle/rPSA and earlier work on multiple fishery stressors Micheli et al. 2014, A risk-based framework for assessing the cumulative impact of multiple fisheries https://web.stanford.edu/group/MicheliLab/pdf/a%20risk%20based%20framework.pdf.  D-PERAMS is free to use, and we welcome feedback to improve the usability of the software.  We only ask that you credit our work and cite our papers in any byproducts resulting from use of D-PERAMS.

Below is a guide to using D-PERAMS.  After downloading and completing templates, analysis occurs within a few seconds of upload.  If your data is well organized to be input into templates, a full analysis from template download to results can occur within a few minutes.  The instructions are divided into three sections: pre-download of templates, template completion, and D-PERAMS analysis.

1. Pre-download of templates

- Determine the types of response and stressor variables used in analysis (e.g. Productivity-Susceptibility, Exposure-Effect/Sensitivity, Severity-Likelihood)
- Generate a set of one or more stressor variables that independently contribute to risk
- Decide which set of attributes will be used to assess each of the variables.  If more than one stressor is included, different attributes may be used for different types of stressors, though care should be taken to interpret results appropriately given the added complexity of the analysis.  Chosen attributes should be approximately independent from each other.  Highly correlated/redundant attributes should not be included in the analysis.  If moderately-highly correlated attributes are used, refer to the supplement of Grewelle et al. 2021, \textit{Redefining Risk in Data-Poor Fisheries} to estimate the effective number of attributes used for each variable.  
- Classify each variable as additive or multiplicative in nature.  When an additive model is used for a variable, it is assumed that each attribute contributes to a fraction of risk proportional to its weight (see following instruction on weighting). Therefore, adding all attribute contributions to risk gives the full risk associated with the variable.  When a multiplicative model is used for a variable, it is assumed that each attribute's contribution is affected by the contributions of other attributes.  Simply, if risk from one or more attributes is absent, overall risk associated with the variable would be absent as well even when high risk is associated with other attributes.  This model is often used when attributes measured operate in a sequence or are probabilistic (e.g. Likelihood).  By default, response variables are additive and stressor variables are multiplicative in the templates.  Different models can be used for each stressor, though care should be taken to interpret results appropriately given the added complexity of the analysis.
- Set criteria for low, medium, and high risk for each variable.  This consists of two percentile cut-offs, below the first is low, above the second is high, and between them is medium risk.  These cut-offs can be chosen as any percentile provided they are symmetric (i.e. low and high categories are of equal range).  The template defaults assume equally sized categories.
- Assign weights to each attribute.  Weights can take any numerical value and are only important relative to weights of other attributes for a single species or endpoint. Weights can differ within an attribute but across species.  The template defaults to equal weighting.
- Score attributes for all species.  Attribute scores should take values between 1 and 3. These values should fall within intended categories based on the percentile cut-offs assigned above.  Defaults correspond to 1 = low risk, 2 = medium risk, 3 = high risk. 

-----------------------------------------------------------------------

2. Template completion

- Download one alpha template and one beta csv template.
- Open the alpha template.  The top four rows have six sets of values to input. 
  a) Additive or Multiplicative attributes?  Acceptable inputs: Additive, Multiplicative
  b) Low and high percentile cut-offs for attribute scoring.  Acceptable inputs: any two fractions that as cut-offs produce a symmetric distribution of score ranges.      Numerators and denominators must include a decimal.  Values must remain in fraction form (i.e. do not give the decimal equivalent of the fraction).
  c) Number of attributes.  Acceptable input: a whole number corresponding to the number of attribute columns.
  d) Low and high thresholds.  Acceptable inputs: The second value must be larger than the first.  Numerators and denominators must include a decimal.  Values must remain in fraction form (i.e. do not give the decimal equivalent of the fraction).  These thresholds determine the risk categories following Vulnerability scoring.
  e) Scoring in reversed risk order? Acceptable inputs: Y, N.  In some cases (e.g. Productivity) the attributes of the alpha variable may be scored such that high values represent low risk.  If scores input in the template were scored in this way, assign Y to this field.  If high values correspond to high risk, assign N to this field.
  f) Axis label. Acceptable inputs: any x-axis label for the resulting plot, preferably the name of the alpha variable.
- Row 5 must be left empty. Row 6 is the dataset header, and values in these cells can be changed without affecting the analysis.
- Columns must be organized accordingly: column 1 is for higher level organization of species and will not be output in results.  Column 2 is the list of species and will be reported in results alongside Vulnerability scores and risk categories.  Input your list of species in column 2.  No input is required for column 1 unless it is helpful for your organization.  Blank rows can be included in between species or chunks of species for aesthetics without affecting the analysis provided the blank rows are placed consistently for all templates so that species fall on the same row.
- Columns 3+ are for attribute scores and weights.  Add or remove columns to rows 6+ to add or subtract attributes.  Two empty columns must be kept between attribute scores and attribute weights.  Attribute weight columns must be in the same order, left to right, as the attribute columns.  For example, for 5 attributes, columns 1 and 2 would report group (optional) and species (or endpoint generally).  Columns 3-7 would report attribute scores.  Columns 8-9 would be blank.  Columns 10-14 would report attribute weights. When an attribute is unscored due to lack of data or irrelevance for the species, both the attribute score and weight cells should be left blank. Default attribute scores are randomly chosen between 1 and 3.  Default weights are equal.
- Save the alpha template as alpha_xxx.csv where xxx is any string you choose.
- Open the beta template.  Like the alpha template, the top four rows have six sets of values to input.  These sets of values can be entered according to the guidelines for the alpha template above except for (e).  Here the entry differs: Compound model? Acceptable inputs: Y, N.  This entry refers to whether the stressor is statistically standardized by the expected mean or the expected minimum.  By default, this value should be N for the first beta template to yield a comparable analysis to the rPSA for a single stressor.  Subsequent stressors can be treated as compounding (increasing risk with more stressors -- Y) or not (N) by completing additional beta templates for each stressor.
- The same rules apply for column and row formatting and data entry for both beta and alpha templates.  It is recommended to rank stressors in order of impact, with the highest impact stressor entered in the first beta template, and the lowest impact stressor entered in the last beta template.  All values can differ between stressors except for (d) low and high thresholds.  These thresholds will be the same across all templates, including the alpha template, as the thresholds are applied to Vulnerability scores at the end of the analysis.  The software is setup to take the threshold values from the alpha template, so modifying the thresholds in the beta templates will not change results.
- Save each beta template as beta1_xxx.csv, beta2_xxx.csv, beta3_xxx.csv, etc. in the same folder as you saved the completed alpha template.  Ordering of these completed templates matters in the upload stage, as all files are selected simultaneously.  Therefore, in the folder, files must appear in the following order: alpha_xxx.csv, beta1_xxx.csv, beta2_xxx.csv, beta3_xxx.csv, etc. 

------------------------------------------------------------------------

3. D-PERAMS analysis

- Navigate to the main page of d-perams.com.
- Click on the 'Choose Files' button after which a file browser window will appear.  Navigate to the folder hosting your completed templates.  The order the files appear is the order they will be uploaded and should be in the order described above.  Use ctrl (or cmd) + select or shift select to select all files to be analyzed.
- After opening these files, the homepage will read the number of files selected.  Click 'Submit' to analyze your data.
- After a few seconds, a display page will appear with results.  Results will appear in order of the stressors uploaded with stressor 1 corresponding to beta1_xxx.csv.  These are single stressor results for each stressor standardized by the expected mean.  Each plot will precede a list of all species and their associated probabilistic Vulnerability score between 0 (lowest) and 1 (highest) and their associated risk category determined by the thresholds set.  The final result is the multiple stressor result.
- All figures can be downloaded by saving the image with a right click, and the data tables can be copied and pasted directly into any format like a csv file.


